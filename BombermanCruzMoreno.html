<<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Practica Canvas5, CruzMorenoJesusEnrique</title>
  </head>

  <body style="background-color: rgb(214, 214, 214)"> 
    <center><canvas id="canvas01" width="1000" height="1000"> </canvas></center>
  </body>
  
  <div style="display:none;"> 
  <script>
    window.requestAnimationFrame = (function () {
      return (
        window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        function (callback) {
          window.setTimeout(callback, 17);
        }
      );
    })();
    window.requestAnimationFrame(update);
    //LA CASILLAS VAN A MEDIR 40 por que el espacio a usar 960
    //POR LO TANTO TENEMOS UN TOTAL DE 24*24 = 576
    //MEDIDA DE BLOQUE NUEVA ES 32 POR LO TANTO TENEMOS UN TOTAL DE 24*32 = 768

   //CLASE JUGADOR --------
   class Jugador {
      constructor(w, h) {
        this.x = 0;
        this.y = 0;
        this.w = w;
        this.h = h;
        // this.speed = 8;
      }

      pintar(ctx) {
        ctx.fillStyle = "Cyan";
        ctx.fillRect(this.x, this.y, this.w, this.h);
      }
    }

    class Muro{
      constructor(x, y, w, h, destruible) {
        this.x = x;
        this.y = y;
        this.w = w;
        this.h = h;
        this.destruible = destruible;
        this.destruido = false;
      }


      pintar (ctx){
        if(!this.destruible){
          ctx.fillStyle = "Gray";
           ctx.fillRect(this.x, this.y, this.w, this.h);
        }else{ 
          ctx.fillStyle = "#C70039";
           ctx.fillRect(this.x, this.y, this.w, this.h);
        }

      }

      playerCollider(personaje) {
        if (
            this.x < personaje.x + personaje.w  &&  
                this.x + this.w > personaje.x &&    
                this.y < personaje.y + personaje.h &&    
                this.y + this.h> personaje.y
        ) {
          console.log("Chin me pegue!");
          switch (dir) {
            case 0:
              personaje.y += 1;
              break;

            case 1:
              personaje.y -= 1;
              break;

            case 2:
              personaje.x -= 1;
              break;

            case 3:
              personaje.x += 1;
              break;

            default:
              break;
          }
          dir = 4;
          return true;
        }
        return false;
      }
    }


    var canvas = document.getElementById("canvas01");
    var ctx = canvas.getContext("2d");
    var casilla = 24;
    var estado = 0;


    //MURO = M, UBICACIONES DE SPAWN= X, TODO LO DEMAS SE PUEDE LLENAR
    const nivel_prueba = [
  ['M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M'],
  ['M','x','x',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'x','x','M'],
  ['M','x','M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,   ,'M',   ,'x','M'],
  ['M','x','M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,   ,'M',   ,'x','M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'M'],
  ['M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,'M'],
  ['M','x',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'x','M'],
  ['M','x','M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,'M',   ,   ,   ,'M',   ,'x','M'],
  ['M','x','x',   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,   ,'x','x','M'],
  ['M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M','M']
];

let bloquesEnCavas = [];

function generacion(){
  bloquesEnCavas = [];

  for (let f = 0; f < 24; f++){
    bloquesEnCavas[f] = [];

    for (let c = 0; c < 24; c++){
      if(!nivel_prueba[f][c] && Math.random() < 0.85){
        bloquesEnCavas[f][c] = new Muro((32*f),(32*c),32,32, true);

      }else if (nivel_prueba[f][c] == 'M'){
        bloquesEnCavas[f][c] = new Muro((32*f),(32*c),32,32, false);
      }else{

      }
    }
  }
}



  generacion();

  function update() {
    repaint();
    window.requestAnimationFrame(update);
  }


  function repaint() {
    for(let x = 0; x < 24; x++){
      for(let y = 0; y < 24; y++){
        if(bloquesEnCavas[x][y]){bloquesEnCavas[x][y].pintar(ctx);}
     }
    }
  }
  </script>
</html>
